<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My Monad Day 1 Toolkit</title>
  <link rel="icon" type="image/png" href="logomark_light.png" />
  <link rel="icon" type="image/svg+xml" href="logomark_light.svg" />

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body {
      background: radial-gradient(circle at top, #3B1477, #0C021F 70%);
      font-family: system-ui, sans-serif;
    }
  </style>
</head>

<body class="min-h-screen text-white">

<header class="w-full bg-black/40 backdrop-blur-md border-b border-white/10 py-4 px-6 flex items-center gap-3">
  <div class="w-3 h-3 rounded-full" style="background: radial-gradient(circle, #D767FF 0%, #8A4BFF 90%); box-shadow: 0 0 12px #D767FF;"></div>
  <span class="text-xl font-semibold tracking-wide text-white">Monad Day 1 Toolkit</span>
</header>

<div id="mobile-progress" class="md:hidden flex justify-center gap-2 mt-6"></div>

<div class="w-full max-w-5xl mx-auto space-y-4 mt-10 px-4">

  <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
    <div id="app" class="md:col-span-2 space-y-8"></div>

    <div id="result-card" class="h-fit sticky top-10 p-4 rounded-xl bg-white/5 border border-white/10 backdrop-blur shadow-lg hidden">
  <h3 class="text-lg font-semibold mb-2 text-center">My Toolkit</h3>
  <p class="text-sm text-white/70 text-center mb-4">~ on Mainnet Day 1 ~</p>

      <div id="copied-overlay" class="pointer-events-none opacity-0 transition-opacity duration-500
        fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 
        px-6 py-3 rounded-xl border border-[#D767FF] text-[#D767FF] bg-black/40 backdrop-blur-lg">
          Copied ✦
      </div>

  <div id="result-content" class="space-y-1 text-sm mb-4"></div>
   <p id="powered-card" class="text-[11px] text-white/35 mt-3 text-right">
    Powered by Neverland ✦
  </p>
      
  <!-- SHARE BUTTON -->
  <button id="share-btn"
    class="w-full mt-2 py-2 rounded-lg text-sm font-medium bg-gradient-to-r from-[#D767FF] to-[#8A4BFF] hover:opacity-90 transition">
    Share it on X ✦
  </button>
</div>
  </div>
</div>

<div id="mobile-save-screen" class="fixed inset-0 bg-black/90 backdrop-blur-lg hidden z-50 flex flex-col justify-center items-center p-6 text-center">
  <img id="mobile-save-image" class="max-w-[90%] max-h-[70%] rounded-xl shadow-2xl" />
  <p class="text-white/80 mt-5 text-sm">Tap & hold the image → Save to Photos</p>

  <button id="mobile-close" class="mt-6 px-5 py-2 text-sm bg-white/10 border border-white/30 rounded-lg text-white">
    Done ✦
  </button>
</div>

<footer class="fixed bottom-3 left-3 text-xs text-white/40">
  Powered by <a href="https://x.com/Neverland_Money" target="_blank" class="text-[#D767FF] hover:underline">Neverland ✦</a>
</footer>  
  
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script>
const groups = {
  "Infra": {
    Wallets: ["Phantom", "Backpack", "Metamask", "Rabby", "Haha Wallet"],
    Bridges: ["Wormhole", "LayerZero"]
  },
  "DeFi": {
    DEX: ["Kuru", "Uniswap", "LFJ", "Curve", "Purps", "Monday Trade"],
    Lending: ["Neverland", "Euler", "Curvance"],
    Perps: ["Perpl", "Drake"],
    "Liquid Staking": ["Fastlane", "Magma", "Kintsu"]
  },
  "Ecosystem": {
    Launchpad: ["Alloca", "Cult"],
    NFTs: ["OpenSea", "Magic Eden", "Kingdomly", "Poply"],
    "Prediction Markets": ["Kizzy", "RBS", "Levr"]
  }
};

const state = {};
let openGroup = "Infra"; // groupe visible par défaut
  
const app = document.getElementById("app");
const resultCard = document.getElementById("result-card");
const resultContent = document.getElementById("result-content");

let currentStep = 0;

function isMobile() {
  return window.matchMedia("(max-width: 768px)").matches;
}

function render() {
  app.innerHTML = "";

  const groupList = Object.entries(groups);
  const flatCategories = groupList.flatMap(([_, cats]) => Object.keys(cats));

  // --- MOBILE STEP MODE ---
  if (isMobile()) {
    const categoryName = flatCategories[currentStep];
    const options = groupList.flatMap(([_, cats]) => cats[categoryName] ?? []);

    const container = document.createElement("div");
    container.className = "space-y-4";

    container.innerHTML = `<h2 class="text-2xl font-semibold">${categoryName}</h2>`;

    const buttons = document.createElement("div");
    buttons.className = "flex flex-wrap gap-3";

    options.forEach(option => {
      const active = state[categoryName] === option;
      const btn = document.createElement("button");
      btn.className = `
        px-4 py-2 rounded-full text-sm border transition
        ${active 
          ? "bg-gradient-to-r from-[#D767FF] to-[#8A4BFF] border-transparent shadow-md scale-105"
          : "bg-white/5 border-white/20 hover:border-white/40"}
      `;
      btn.textContent = option;
      btn.onclick = () => { state[categoryName] = option; updateCard(); render(); };
      buttons.appendChild(btn);
    });

    container.appendChild(buttons);

    const nav = document.createElement("div");
    nav.className = "flex justify-between mt-6 text-sm";

    nav.innerHTML = `
      <button ${currentStep === 0 ? "disabled" : ""} class="px-4 py-2 bg-white/10 border border-white/20 rounded-lg">Back</button>
      <button class="px-4 py-2 bg-gradient-to-r from-[#D767FF] to-[#8A4BFF] rounded-lg">Next</button>
    `;

    nav.children[0].onclick = () => { currentStep--; render(); };
    nav.children[1].onclick = () => { if (currentStep < flatCategories.length - 1) currentStep++; render(); };

    container.appendChild(nav);
    app.appendChild(container);

    const progress = document.getElementById("mobile-progress");
    progress.innerHTML = flatCategories.map((_, i) => `
      <div class="transition-all duration-300 ${i === currentStep ? "w-6 bg-[#D767FF]" : "w-2 bg-white/30"} h-2 rounded-full"></div>
    `).join("");

    return;
  }

  // --- DESKTOP MODE ---
Object.entries(groups).forEach(([groupName, categories]) => {
  const isOpen = openGroup === groupName;

  const groupBlock = document.createElement("div");
  groupBlock.className = "rounded-xl bg-white/5 border border-white/10 backdrop-blur transition-all";

  // header
  const header = document.createElement("div");
  header.className = "flex justify-between items-center p-4 cursor-pointer select-none";
  header.innerHTML = `
    <h2 class="text-2xl font-semibold">${groupName}</h2>
    <span class="transition-transform duration-200 ${isOpen ? 'rotate-180' : ''}">▼</span>
  `;
  header.onclick = () => { openGroup = groupName; render(); };
  groupBlock.appendChild(header);

  // only show the inner content when open
  if (isOpen) {
    const inner = document.createElement("div");
    inner.className = "p-4 space-y-4 border-t border-white/10";

    Object.entries(categories).forEach(([category, options]) => {
      const section = document.createElement("div");
      section.className = "space-y-2";

      section.innerHTML = `<h3 class="text-lg font-medium">${category}</h3><div class='flex flex-wrap gap-3'></div>`;
      const buttons = section.querySelector("div");

      options.forEach(option => {
        const chosen = state[category] === option;
        const btn = document.createElement("button");
        btn.className = `
          px-4 py-2 rounded-full text-sm border transition
          ${chosen 
            ? "bg-gradient-to-r from-[#D767FF] to-[#8A4BFF] border-transparent shadow-md scale-105"
            : "bg-white/5 border-white/20 hover:border-white/40"}
        `;
        btn.textContent = option;
        btn.onclick = () => { 
        state[category] = option;
        updateCard();
        autoAdvanceIfComplete(groupName, categories);
        render(); // ← REFRESH pour mettre la couleur active immédiatement
      };

        buttons.appendChild(btn);
      });

      inner.appendChild(section);
    });

    groupBlock.appendChild(inner);
  }

  app.appendChild(groupBlock);
});
}

function updateCard() {
  let html = "";

  Object.entries(groups).forEach(([groupName, categories]) => {
    Object.keys(categories).forEach(category => {
      const val = state[category] || "";
      html += `
        <div class="flex justify-between">
          <span class="text-white/60">${category}</span>
          <span>${val}</span>
        </div>
      `;
    });
  });

  resultContent.innerHTML = html;
  resultCard.classList.remove("hidden");
}

function autoAdvanceIfComplete(currentGroup, categories) {
  // Check if every category inside currentGroup has one choice
  const allChosen = Object.keys(categories).every(cat => state[cat]);

  if (!allChosen) return;

  const groupNames = Object.keys(groups);
  const currentIndex = groupNames.indexOf(currentGroup);

  if (currentIndex < groupNames.length - 1) {
    openGroup = groupNames[currentIndex + 1];
  }

  render();
}
  
document.getElementById("share-btn").onclick = shareCard;

async function shareCard() {
  const card = document.getElementById("result-card");
  const mobileScreen = document.getElementById("mobile-save-screen");
  const mobileImage = document.getElementById("mobile-save-image");
  const closeBtn = document.getElementById("mobile-close");
  const overlay = document.getElementById("copied-overlay");
  const isMobile = /iPhone|iPad|Android/i.test(navigator.userAgent);

  const tweetText = `this is my Monad Mainnet Toolkit. day 1 is gonna be a movie ✦
make yours here: https://nafyn.github.io/neverland-monadtoolkit/index.html`;
  const tweetUrl = "https://twitter.com/intent/tweet?text=" + encodeURIComponent(tweetText);
  
// === MOBILE ===
{
  const tweetText = `this is my Monad Mainnet Toolkit. day 1 is gonna be a movie ✦
make yours here: https://nafyn.github.io/neverland-monadtoolkit/index.html`;
  const tweetUrl = "https://twitter.com/intent/tweet?text=" + encodeURIComponent(tweetText);

  // 1) Cloner la carte
  const card = document.getElementById("result-card");
  const mobileScreen = document.getElementById("mobile-save-screen");
  const mobileImage  = document.getElementById("mobile-save-image");
  const closeBtn     = document.getElementById("mobile-close");

    const clone = card.cloneNode(true);

  // retirer le bouton du clone
  const btn = clone.querySelector("#share-btn");
  if (btn) btn.remove();

  // ✅ supprimer le powered déjà présent dans la carte (ce qui cause le doublon)
  const oldPowered = clone.querySelector("#powered-card");
  if (oldPowered) oldPowered.remove();

  // éviter les artefacts iOS (html2canvas ne gère pas backdrop-filter)
  clone.classList.remove("backdrop-blur");
  clone.style.backdropFilter = "none";

  // 2) Construire un conteneur temporaire HORS-ÉCRAN avec le BON fond
  const temp = document.createElement("div");
  temp.style.position = "absolute";
  temp.style.left = "-99999px";
  temp.style.top = "0";
  temp.style.width = "100vw";
  temp.style.minHeight = "100vh";
  temp.style.padding = "24px";
  temp.style.boxSizing = "border-box";
  temp.style.display = "flex";
  temp.style.alignItems = "center";
  temp.style.justifyContent = "center";
  // ✅ même gradient que ta page
  temp.style.background = "radial-gradient(circle at top, #3B1477, #0C021F 70%)";

  // 3) Forcer une largeur jolie (plein écran mobile, sans déformer)
  clone.style.width = "92vw";
  clone.style.maxWidth = "640px";
  clone.style.margin = "0 auto";
  clone.style.borderRadius = "20px";

  // === Ajouter "Powered by Neverland ✦" dans l'image exportée (non cliquable) ===
const poweredClone = document.createElement("p");
poweredClone.textContent = "Powered by Neverland ✦";
poweredClone.style.position = "absolute";
poweredClone.style.right = "14px";
poweredClone.style.bottom = "14px";
poweredClone.style.fontSize = "12px";
poweredClone.style.color = "rgba(255,255,255,0.55)";
poweredClone.style.pointerEvents = "none"; // sécurité : ne casse aucun click
clone.style.position = "relative"; // nécessaire pour l'ancrage en bas-gauche
clone.appendChild(poweredClone);

  // ajouter et capturer
  temp.appendChild(clone);
  document.body.appendChild(temp);

  const canvas = await html2canvas(temp, {
    backgroundColor: null,
    scale: window.devicePixelRatio * 1.6
  });

  // nettoyer
  document.body.removeChild(temp);

  // 4) Afficher l’UI de sauvegarde (tap & hold → Save Image)
  const dataUrl = canvas.toDataURL("image/png");
  mobileImage.src = dataUrl;
  mobileScreen.classList.remove("hidden");

  // 5) Après “Done ✦” → ouvrir Twitter
  closeBtn.onclick = () => {
    mobileScreen.classList.add("hidden");
    window.open(tweetUrl, "_blank");
  };

  return;
}
  
}

render();
</script>

</body>
</html>
